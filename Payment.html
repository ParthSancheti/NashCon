    <!DOCTYPE html>
    <html lang="en">
    <head>
        <!-- Favicon -->
        <link rel="icon" href="src/favicon.ico" type="image/x-icon">
        <link rel="shortcut icon" href="src/favicon.ico" type="image/x-icon">
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
        <title>Premium Payment Website</title>
        <link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" />
        <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.3/dist/umd/popper.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
        <style>
            /* Reset & base */
            *, *::before, *::after {
                box-sizing: border-box;
            }
            body, html {
                margin: 0;
                padding: 0;
                height: 100%;
                font-family: 'Arial', sans-serif;
                background: url('src/Nashlogo.jpg') no-repeat center center fixed;
                background-size: cover;
                overflow-x: hidden;
                color: #FFFFFF;
                min-height: 100vh;
            }

            /* Main container */
            .main-container {
                width: 100%;
                background: rgba(33, 63, 51, 0.4);
                backdrop-filter: blur(5.8px);
                border-radius: 20px;
                padding-left: 20%;
                padding-right: 20%;
                padding-top: 3%;
                padding-bottom: 3%;
                box-shadow: 0 8px 30px rgba(33, 63, 51, 0.8);
                color: #FFFFFF;
                display: flex;
                flex-direction: column;
                align-items: center;
                gap: 30px;
                flex-wrap: wrap;
                min-height: 100vh;
                box-sizing: border-box;
            }

            /* Headings */
            h1 {
                font-size: 3rem;
                font-weight: 900;
                color: #000000;
                user-select: none;
            }

            /* Table container */
            .table-container {
                width: 100%;
                background: rgba(33, 63, 51, 0.5);
                border-radius: 20px;
                overflow: hidden;
                box-shadow: 0 8px 30px rgba(33, 63, 51, 0.7);
                margin: 0 auto;
            }

            #plan-table {
                width: 100%;
                border-collapse: collapse;
            }

            #plan-table th, #plan-table td {
                padding: 15px;
                text-align: center;
                vertical-align: middle;
            }

            #plan-table th {
                background: rgba(203, 177, 142, 0.2);
                font-weight: 900;
                font-size: 1.2rem;
                color: #213F33;
            }

            #plan-table td {
                background: rgba(255, 255, 255, 0.05);
                font-weight: 600;
                font-size: 1rem;
                color: #FFFFFF;
            }

            #plan-table .plan-image {
                width: 100px;
                height: 100px;
                margin: 0 auto 10px;
            }

            #plan-table .plan-image img {
                width: 100%;
                height: 100%;
                object-fit: cover;
                border-radius: 10px;
            }

            .included {
                color: #213F33;
            }

            .not {
                color: #213F33;
                font-style: italic;
            }

            .price {
                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                font-size: 1.1rem;
                letter-spacing: 0.05em;
                color: #CBB18E;
            }

            /* Plan continue button */
            .btn-plan-continue {
                margin-top: 10px;
                padding: 10px 26px;
                background-color: #CBB18E;
                color: #213F33;
                font-weight: 700;
                font-size: 1.1rem;
                border: none;
                border-radius: 14px;
                cursor: pointer;
                box-shadow: 0 5px 12px rgba(33, 63, 51, 0.7);
                transition: background-color 0.3s ease;
                user-select: none;
            }
            .btn-plan-continue:hover,
            .btn-plan-continue:focus {
                background-color: #b99a74;
                outline: none;
            }

            #participant-section {
                background: rgba(33, 63, 51, 0.5);
                border-radius: 20px;
                padding: 25px 27px 40px 27px;
                width: 100%;
                box-shadow: 0 8px 24px rgba(33, 63, 51, 0.6);
                color: #FFFFFF;
                display: none;
                flex-direction: column;
                align-items: center;
                gap: 16px;
                box-sizing: border-box;
                user-select: text;
            }
            #participant-section img {
                width: 180px;
                height: 180px;
                border-radius: 15px;
                box-shadow: 0 8px 20px rgba(33, 63, 51, 0.8);
                object-fit: cover;
                margin-bottom: 20px;
                user-select: none;
                transition: transform 0.4s ease;
                display: block;
                margin-left: auto;
                margin-right: auto;
            }
            #participant-section img:hover {
                transform: scale(1.05);
            }

            form#participant-form {
                width: 100%;
                display: flex;
                flex-direction: column;
                gap: 20px;
                user-select: text;
            }

            /* First/Last on same line */
            .row-inputs {
                display: flex;
                gap: 14px;
                width: 100%;
            }
            .row-inputs > input,
            .row-inputs > select {
                flex: 1;
            }
            select option {
                background: rgba(33, 63, 51, 0.95);
                backdrop-filter: blur(6px);
                -webkit-backdrop-filter: blur(6px);
                color: #FFFFFF;
            }

            /* Fields styling */
            input[type="text"],
            input[type="tel"],
            input[type="email"],
            textarea,
            select {
                background: rgba(255, 255, 255, 0.1);
                -webkit-backdrop-filter: blur(8px);
                border: none;
                border-radius: 12px;
                padding: 17px 15px;
                font-size: 1rem;
                backdrop-filter: blur(6px);
                color: #FFFFFF;
                font-weight: 600;
                outline-offset: 2px;
                outline-color: transparent;
                line-height: 1.4;
                font-family: inherit;
                transition: box-shadow 0.25s ease;
                box-sizing: border-box;
                box-shadow: inset 0 0 5px rgba(33, 63, 51, 0.5);
                width: 100%;
            }
            input[type="text"]:focus,
            input[type="tel"]:focus,
            input[type="email"]:focus,
            textarea:focus,
            select:focus {
                box-shadow: 0 0 8px #CBB18E;
                outline-color: #CBB18E;
            }
            textarea {
                resize: vertical;
                min-height: 80px;
            }

            label {
                font-weight: 700;
                font-size: 1.1rem;
                margin-bottom: 5px;
                color: #CBB18E;
                display: block;
            }

            /* Committee Preference Dropdown with checkboxes */
            .dropdown-container {
                position: relative;
                width: 100%;
                user-select: none;
            }
            .dropdown-header {
                background-color: rgba(255, 255, 255, 0.1);
                border-radius: 12px;
                padding: 10px 15px;
                font-weight: 700;
                color: #FFFFFF;
                cursor: pointer;
                backdrop-filter: blur(6px);
                display: flex;
                justify-content: space-between;
                align-items: center;
                font-size: 1rem;
                box-shadow: inset 0 0 5px rgba(33, 63, 51, 0.5);
                user-select: none;
            }
            .dropdown-header::after {
                content: "▾";
                font-size: 1.25rem;
                color: #CBB18E;
                margin-left: 10px;
                transition: transform 0.3s ease;
                user-select: none;
            }
            .dropdown-header.open::after {
                transform: rotate(180deg);
            }
            .dropdown-list {
                position: absolute;
                top: 100%;
                left: 0;
                right: 0;
                background: rgba(33, 63, 51, 0.7);
                border-radius: 0 0 12px 12px;
                max-height: 180px;
                overflow-y: auto;
                box-shadow: 0 8px 24px rgba(33, 63, 51, 0.6);
                z-index: 10;
                display: none;
                padding: 5px 10px;
                box-sizing: border-box;
            }
            .dropdown-list.open {
                display: block;
            }
            .dropdown-list label {
                display: flex;
                align-items: center;
                gap: 8px;
                padding: 6px 8px;
                font-weight: 600;
                color: #FFFFFF;
                cursor: pointer;
                user-select: none;
                border-radius: 8px;
                transition: background-color 0.2s ease;
            }
            .dropdown-list label:hover {
                background-color: rgba(203, 177, 142, 0.2);
            }
            .dropdown-list input[type="checkbox"] {
                width: 16px;
                height: 16px;
                cursor: pointer;
                user-select: none;
                filter: drop-shadow(0 0 0.7px #999);
                border-radius: 3px;
            }
            .blurred-select {
                background: rgba(255, 255, 255, 0.1);
                backdrop-filter: blur(8px);
                border: none;
                border-radius: 12px;
                padding: 10px 15px;
                font-size: 1rem;
                color: #FFFFFF;
                font-weight: 600;
                width: 100%;
                box-shadow: inset 0 0 5px rgba(33, 63, 51, 0.5);
            }
            .blurred-select option {
                background: rgba(33, 63, 51, 0.9);
                backdrop-filter: blur(6px);
                color: #fff;
            }

            /* Footer small text */
            .footer-text {
                width: 100%;
                text-align: right;
                font-size: 0.75rem;
                font-weight: 700;
                color: #CBB18E;
                user-select: none;
                padding-right: 10px;
                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            }

            /* Checkout Modal Styles */
            #checkout-modal {
                position: fixed;
                inset: 0;
                background: rgba(33, 63, 51, 0.9);
                display: none;
                justify-content: center;
                align-items: flex-end;
                padding-bottom: 20px;
                z-index: 10000;
                user-select: none;
                overflow-y: auto;
                pointer-events: auto; /* Ensure modal captures all pointer events */
            }
            #checkout-content {
                background: rgba(33, 63, 51, 0.85);
                border-radius: 20px;
                padding: 30px 40px;
                color: #FFFFFF;
                text-align: center;
                max-width: 400px;
                width: 90%;
                box-shadow: 0 0 40px rgba(203, 177, 142, 0.8);
                position: relative;
                pointer-events: auto; /* Ensure content captures pointer events */
            }
            #checkout-content img#qrCode {
                width: 180px;
                height: 180px;
                border-radius: 20px;
                margin-bottom: 20px;
                box-shadow: 0 0 15px rgba(203, 177, 142, 0.8);
                user-select: none;
            }
            #amount-display {
                font-size: 1.2rem;
                font-weight: 700;
                color: #CBB18E;
                margin-bottom: 10px;
            }
            .payment-button, .enquiry-button {
                display: inline-flex;
                align-items: center;
                background: linear-gradient(180deg, #CBB18E 0%, #CBB18E 100%);
                border: none;
                border-radius: 12px;
                color: #213F33;
                font-size: 1rem;
                font-weight: 700;
                padding: 15px 25px;
                text-decoration: none;
                cursor: pointer;
                transition: background 0.2s ease-in-out, color 0.2s ease-in-out; /* Restrict transitions to background and color */
                margin-bottom: 20px;
                width: 100%;
                justify-content: center;
                pointer-events: auto; /* Ensure buttons are clickable */
            }
            .payment-button:hover, .enquiry-button:hover {
                background: #213F33;
                color: #FFFFFF;
            }
            .payment-button::before {
                content: '\f555';
                font-family: 'Font Awesome 5 Free';
                font-weight: 900;
                margin-right: 10px;
            }
            .enquiry-button::before {
                content: '\f232';
                font-family: 'Font Awesome 5 Brands';
                margin-right: 10px;
            }
            #checkout-content label.custom-file-button {
                display: inline-flex;
                align-items: center;
                gap: 6px;
                background-color: #CBB18E;
                color: #213F33;
                padding: 8px 12px;
                border-radius: 8px;
                cursor: pointer;
                font-weight: 600;
                margin-bottom: 10px;
            }
            #checkout-content svg.fa-plus {
                width: 16px;
                height: 16px;
            }
            #paymentScreenshot {
                display: none;
            }
            #file-name {
                display: block;
                font-size: 0.9rem;
                color: #CBB18E;
                font-weight: 600;
                margin-bottom: 15px;
            }
            #checkout-content button#submitBtn {
                background: linear-gradient(180deg, #CBB18E 0%, #CBB18E 100%);
                border: none;
                border-radius: 12px;
                color: #213F33;
                font-size: 1rem;
                font-weight: 700;
                padding: 15px 25px;
                cursor: pointer;
                transition: all 0.2s ease-in-out;
                width: 100%;
            }
            #checkout-content button#submitBtn:hover {
                background: #213F33;
                color: #FFFFFF;
            }
            #closeCheckoutBtn {
                position: absolute;
                top: 12px;
                right: 12px;
                background: transparent;
                border: none;
                font-size: 1.5rem;
                color: #FFFFFF;
                cursor: pointer;
                user-select: none;
                padding: 4px 8px;
                font-weight: 900;
                line-height: 1;
            }
            #closeCheckoutBtn:hover {
                color: #CBB18E;
            }

            .main-container {
                position: relative;
            }

            .plan-header {
                display: flex;
                align-items: center;
                width: 100%;
            }

            .back-button {
                margin-right: 16px;
                flex-shrink: 0;
            }

            .back-button img {
                width: 32px;
                height: 32px;
                object-fit: contain;
                cursor: pointer;
            }

            /* Custom file upload styles */
            .file-upload-label {
                display: block;
                font-weight: 700;
                font-size: 0.9rem;
                margin: 20px 0 6px 0;
                color: #CBB18E;
                cursor: pointer;
            }

            .custom-file-button {
                display: inline-flex;
                align-items: center;
                background-color: #CBB18E;
                color: #213F33;
                padding: 8px 12px;
                border-radius: 8px;
                margin-top: 5px;
                user-select: none;
            }
            .custom-file-button svg {
                width: 16px;
                height: 16px;
                margin-right: 5px;
            }
            .custom-file-button span {
                font-weight: 600;
            }

            #confirmationPopup {
                position: fixed;
                inset: 0;
                background: rgba(33, 63, 51, 0.9);
                display: none;
                justify-content: center;
                align-items: flex-end;
                padding-bottom: 170px;
                z-index: 11000;
                user-select: none;
                overflow-y: auto;
            }
            #confirmationContent {
                background: rgba(33, 63, 51, 0.85);
                border-radius: 20px;
                padding: 30px 40px;
                color: #FFFFFF;
                text-align: center;
                max-width: 350px;
                box-shadow: 0 0 40px rgba(203, 177, 142, 0.8);
                position: relative;
            }
            #confirmationContent svg {
                width: 100px;
                height: 100px;
                margin: 0 auto 15px;
                stroke: #FFFFFF;
                stroke-width: 5;
                fill: none;
                stroke-linecap: round;
                stroke-linejoin: round;
                animation: drawcheck 0.8s forwards;
                user-select: none;
            }
            #confirmationContent h2 {
                margin-bottom: 15px;
                font-weight: 900;
                font-size: 1.8rem;
                color: #CBB18E;
            }
            #confirmationContent p {
                font-weight: 600;
            }
            #closeConfirmationBtn {
                background: #CBB18E;
                color: #213F33;
                border: none;
                padding: 10px 24px;
                border-radius: 12px;
                font-weight: 700;
                cursor: pointer;
                margin-top: 25px;
                user-select: none;
            }
            #closeConfirmationBtn:hover {
                background: #b99a74;
            }

            /* Animations */
            @keyframes drawcheck {
                0%   { stroke-dashoffset: 100; stroke-dasharray: 100; }
                100% { stroke-dashoffset: 0;   stroke-dasharray: 100; }
            }

            /* Responsive */
            @media (max-width: 900px) {
                .table-container {
                    overflow-x: auto;
                }
                .main-container {
                    padding: 15px 10px;
                }
                #participant-section {
                    width: 95%;
                    padding: 20px 20px 30px 20px;
                }
                .row-inputs {
                    flex-direction: column;
                }
            }
            .preference-selector {
                margin-bottom: 20px;
            }

            .preference-selector select {
                background: rgba(255, 255, 255, 0.1);
                backdrop-filter: blur(8px);
                -webkit-backdrop-filter: blur(8px);
                border: none;
                border-radius: 12px;
                padding: 18px 15px;
                font-size: 1.1rem;
                color: #FFFFFF;
                font-weight: 600;
                width: 100%;
                box-shadow: inset 0 0 5px rgba(33, 63, 51, 0.5);
                appearance: none;
                min-height: 56px;
                line-height: 1.4;
            }

            .preference-selector select option {
                background: rgba(33, 63, 51, 0.95);
                backdrop-filter: blur(6px);
                color: #FFFFFF;
            }

            /* Styles for registration off page */
            #registration-off-container {
                display: none; /* Hidden by default */
                flex-direction: column;
                align-items: center;
                text-align: center;
                padding: 20px;
                background: rgba(33, 63, 51, 0.5);
                border-radius: 20px;
                box-shadow: 0 8px 30px rgba(33, 63, 51, 0.7);
                width: 100%;
                max-width: 600px; /* Adjust as needed */
                margin: 0 auto;
            }
            #registration-off-container img {
                max-width: 100%;
                height: auto;
                border-radius: 15px;
                margin-bottom: 20px;
                box-shadow: 0 8px 20px rgba(33, 63, 51, 0.8);
            }
            #registration-off-container p {
                font-size: 1.2rem;
                font-weight: 600;
                color: #CBB18E;
                margin-bottom: 20px;
            }
            #registration-off-container .back-to-main-button {
                background-color: #CBB18E;
                color: #213F33;
                font-weight: 700;
                font-size: 1.1rem;
                padding: 12px 24px;
                border: none;
                border-radius: 14px;
                cursor: pointer;
                text-decoration: none;
                transition: background-color 0.3s ease;
            }
            #registration-off-container .back-to-main-button:hover {
                background-color: #b99a74;
            }
            /* Fix for buttons becoming transparent or changing color */
#submitBtn,
#whatsappEnquiryButton,
.payment-button,
.enquiry-button,
.custom-file-button {
  background-color: #CBB18E !important;  /* or your specific button color */
  color: #213F33 !important;             /* or your preferred text color */
  border: none;
  transition: transform 0.1s ease, filter 0.1s ease;
}

/* Hover: no transparency, only slight brightness */
#submitBtn:hover,
#whatsappEnquiryButton:hover,
.payment-button:hover,
.enquiry-button:hover,
.custom-file-button:hover {
  background-color: #CBB18E !important;
  color: #213F33 !important;
  filter: brightness(1.05);
}

/* Active (click) state: tap animation only */
#submitBtn:active,
#whatsappEnquiryButton:active,
.payment-button:active,
.enquiry-button:active,
.custom-file-button:active {
  transform: scale(0.97);
  filter: brightness(0.93);
  background-color: #CBB18E !important;
  color: #213F33 !important;
}

/* Disabled state style */
#submitBtn:disabled,
.payment-button:disabled,
.enquiry-button:disabled {
  opacity: 0.6;
  cursor: not-allowed;
  transform: none;
  filter: none;
  background-color: #CBB18E !important;
  color: #213F33 !important;
}

        </style>
    </head>
    <body>
        <div class="main-container" role="main" aria-label="Plan comparison and participant registration">
            <!-- Registration Off Container -->
            <div id="registration-off-container">
                <img src="https://raw.githubusercontent.com/ParthSancheti/NashCon/main/registration-off-img.png" alt="Registrations Are Off" />
                <p>Registrations are currently closed. Please check back later or contact us for more information.</p>
                <a href="https://nashcon.in" class="back-to-main-button">Back to NashCon Main Website</a>
            </div>

            <!-- Original Content (hidden if registrations are off) -->
            <div id="original-content">
                <div class="plan-header">
                    <a href="index.html" class="back-button">
                        <img src="src/back-icon.png" alt="Back" height="50" width="50" />
                    </a>
                    <h1>Choose Your Plan</h1>
                </div>

                <div class="table-container">
                    <table id="plan-table">
                        <thead>
                            <tr>
                                <th>Feature</th>
                                <th>
                                    <div class="plan-image">
                                        <img src="src/mun_socials.jpg" alt="With MUN + Socials Image" loading="lazy" />
                                    </div>
                                    With MUN + Socials
                                </th>
                                <th>
                                    <div class="plan-image">
                                        <img src="src/mun_only.jpg" alt="MUN Only Image" loading="lazy" />
                                    </div>
                                    MUN Only
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Committee Sessions</td>
                                <td><span class="included">✅ Included</span></td>
                                <td><span class="included">✅ Included</span></td>
                            </tr>
                            <tr>
                                <td>Delegate Kits</td>
                                <td><span class="included">✅ Included</span></td>
                                <td><span class="included">✅ Included</span></td>
                            </tr>
                            <tr>
                                <td>Certificates</td>
                                <td><span class="included">✅ Included</span></td>
                                <td><span class="included">✅ Included</span></td>
                            </tr>
                            <tr>
                                <td>Refreshments</td>
                                <td><span class="included">✅ Included</span></td>
                                <td><span class="included">✅ Included</span></td>
                            </tr>
                            <tr>
                                <td>Socials Night (music, networking, etc.)</td>
                                <td><span class="included">✅ Included</span></td>
                                <td><span class="not">❌ Not included</span></td>
                            </tr>
                            <tr>
                                <td>Payment Amount</td>
                                <td><span class="price" id="price-with-socials"></span></td>
                                <td><span class="price" id="price-mun-only"></span></td>
                            </tr>
                            <tr>
                                <td></td>
                                <td><button class="btn-plan-continue" data-plan="With MUN + Socials">Continue</button></td>
                                <td><button class="btn-plan-continue" data-plan="MUN Only">Continue</button></td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <section id="participant-section" aria-label="Participant Details Form">
                    <form id="participant-form" enctype="multipart/form-data" novalidate>
                        <div style="margin-bottom:20px;">
                            <label for="planSelect" style="font-weight:700; font-size:1.1rem; color:#CBB18E;">Selected Plan</label>
                            <input type="text" id="planSelect" name="planSelect" disabled style="background:#ddd; border:none; border-radius:8px; padding:10px 15px; font-size:1rem; color:#333; width:100%;" />
                        </div>
                        <div class="row-inputs">
                            <div style="flex:1;">
                                <label for="firstName">First Name</label>
                                <input id="firstName" name="first_name" type="text" placeholder="First Name" autocomplete="given-name" required />
                            </div>
                            <div style="flex:1;">
                                <label for="lastName">Last Name</label>
                                <input id="lastName" name="last_name" type="text" placeholder="Last Name" autocomplete="family-name" required />
                            </div>
                        </div>
                        <input id="oc" name="campus_ambassador_oc_referral" type="text" placeholder="Campus Ambassador / OC Referral" required />

                        <div style="flex:1;">
                            <label for="email">Email Address</label>
                            <input id="email" name="email" type="email" placeholder="Email Address" autocomplete="email" required />
                        </div>
                        <div>
                            <label for="phoneNumber">Phone Number</label>
                            <input id="phoneNumber" name="phone_number" type="tel" placeholder="Phone Number" autocomplete="tel" required pattern="^[0-9+\-\s]{7,15}$" />
                        </div>
                        <div>
                            <label for="schoolInstitution">School / Institution</label>
                            <input id="schoolInstitution" name="school_institution" type="text" placeholder="School / Institution" required />
                        </div>
                        <div class="row-inputs">
                            <div style="flex:1;">
                                <label for="gradeLevel">Grade Level</label>
                                <select id="gradeLevel" name="grade_level" required>
                                    <option value="" disabled selected>Select Grade Level</option>
                                    <option>9th or below</option>
                                    <option>10th</option>
                                    <option>11th</option>
                                    <option>12th</option>
                                    <option>College</option>
                                </select>
                            </div>
                            <div style="flex:1;">
                                <label for="munExperience">MUN Experience</label>
                                <select id="munExperience" name="mun_experience" required>
                                    <option value="" disabled selected>Select MUN Experience</option>
                                    <option>None (First Timer)</option>
                                    <option>1-2 Conferences</option>
                                    <option>3-5 Conferences</option>
                                    <option>5+ Conferences</option>
                                </select>
                            </div>
                        </div>
                        <!-- Committee Preferences Section -->
                        <div>
                            <label style="color:#CBB18E; font-weight:700; font-size:1.1rem;">Committee Preferences (Max 3)</label>

                            <div class="preference-selector">
                                <label for="committeePreference1" style="color:#CBB18E;">1st Preference (Highest Priority)</label>
                                <select id="committeePreference1" name="committee_1" required class="blurred-select">
                                    <option value="" disabled selected>Select 1st Preference</option>
                                    <option>CRISIS GENESIS COUNCIL</option>
                                    <option>UNITED NATIONS OFFICE OF DRUGS AND CRIME</option>
                                    <option>COLD WAR</option>
                                    <option>UNITED NATIONS WOMENS</option>
                                    <option>LOK SABHA</option>
                                    <option>INTERNATIONAL PRESS</option>
                                    <option>DISARMAMENT AND INTERNATIONAL SECURITY COUNCIL</option>
                                    <option>No Preference</option>
                                </select>
                            </div>

                            <div class="preference-selector">
                                <label for="committeePreference2" style="color:#CBB18E;">2nd Preference</label>
                                <select id="committeePreference2" name="committee_2" required class="blurred-select">
                                    <option value="" disabled selected>Select 2nd Preference</option>
                                    <option>CRISIS GENESIS COUNCIL</option>
                                    <option>UNITED NATIONS OFFICE OF DRUGS AND CRIME</option>
                                    <option>COLD WAR</option>
                                    <option>UNITED NATIONS WOMENS</option>
                                    <option>LOK SABHA</option>
                                    <option>INTERNATIONAL PRESS</option>
                                    <option>DISARMAMENT AND INTERNATIONAL SECURITY COUNCIL</option>
                                    <option>No Preference</option>
                                </select>
                            </div>

                            <div class="preference-selector">
                                <label for="committeePreference3" style="color:#CBB18E;">3rd Preference (Lowest Priority)</label>
                                <select id="committeePreference3" name="committee_3" required class="blurred-select">
                                    <option value="" disabled selected>Select 3rd Preference</option>
                                    <option>CRISIS GENESIS COUNCIL</option>
                                    <option>UNITED NATIONS OFFICE OF DRUGS AND CRIME</option>
                                    <option>COLD WAR</option>
                                    <option>UNITED NATIONS WOMENS</option>
                                    <option>LOK SABHA</option>
                                    <option>INTERNATIONAL PRESS</option>
                                    <option>DISARMAMENT AND INTERNATIONAL SECURITY COUNCIL</option>
                                    <option>No Preference</option>
                                </select>
                            </div>
                        </div>

                        <div>
                            <label for="countryPreference">Country Preference</label>
                            <textarea id="countryPreference" name="country_preference" rows="3" placeholder="Country Preference"></textarea>
                        </div>
                        <div>
                            <label for="specialNeeds">Special Needs / Requests</label>
                            <textarea id="specialNeeds" name="special_needs" rows="3" placeholder="Special Needs / Requests"></textarea>
                        </div>
                        <button id="continueBtn" type="button" style="margin-top: 15px; background-color: #233f33; color: #fff7ed; font-weight: 700; border: none; padding: 12px 20px; border-radius: 12px; font-size: 1.1rem; cursor: pointer;">Continue to Checkout</button>
                    </form>
                    <div class="footer-text"></div>
                </section>

                <!-- Checkout Modal -->
                <div id="checkout-modal" role="dialog" aria-modal="true" aria-labelledby="checkoutTitle" aria-describedby="checkoutDesc">
                    <div id="checkout-content">
                        <button id="closeCheckoutBtn" aria-label="Close checkout window">×</button>
                        <h2 id="checkoutTitle" style="margin-bottom: 15px; font-weight: 900; color: #233f33;">Checkout</h2>
                        <div id="amount-display" style="font-size: 1.2rem; font-weight: 700; color: #CBB18E; margin-bottom: 10px;"></div>
                        <img id="qrCode" alt="Payment QR Code" />
                        <a id="phonePeLink" href="#" class="payment-button">Pay with PhonePe</a>
                        <a id="whatsappEnquiryButton" href="#" class="enquiry-button">For enquiries contact Abhishek Rajput +91 99213 01084</a>
                        <label for="paymentScreenshot" class="file-upload-label">
                            Please attach the payment screenshot to confirm your payment and registration.
                            <div class="custom-file-button">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <line x1="12" y1="5" x2="12" y2="19"></line>
                                    <line x1="5" y1="12" x2="19" y2="12"></line>
                                </svg>
                                <span>Choose File</span>
                            </div>
                        </label>
                        <input type="file" id="paymentScreenshot" name="payment_screenshot" accept="image/*" required style="display: none;" />
                        <span id="file-name" style="display: block; margin-top: 5px; font-size: 0.9rem; color: #CBB18E; font-weight: 600;">No file chosen</span>
                        <div style="background: rgba(203, 177, 142, 0.1); border: 2px solid #CBB18E; border-radius: 12px; padding: 15px; margin: 20px 0; text-align: center;">
                            <p style="margin: 0; font-size: 0.95rem; font-weight: 700; color: #CBB18E; line-height: 1.4;">
                                ⚠️ Please wait for registration to be held valid after pressing Submit.
                            </p>
                        </div>
                        <button id="submitBtn" type="button">Submit</button>
                    </div>
                </div>

                <!-- Confirmation popup -->
                <div id="confirmationPopup" role="dialog" aria-modal="true" aria-labelledby="confirmationTitle" aria-describedby="confirmationDesc">
                    <div id="confirmationContent">
                        <svg viewBox="0 0 52 52" style="width: 100px; height: 100px; margin: 0 auto 15px; stroke:#1e1e1e; stroke-width: 5; fill:none; stroke-linecap: round; stroke-linejoin: round; animation: drawcheck 0.8s forwards;">
                            <circle cx="26" cy="26" r="25" />
                            <path d="M14 27l7 7 16-16" />
                        </svg>
                        <h2 id="confirmationTitle">Payment Submitted Successfully!</h2>
                        <p id="confirmationDesc">Thank you for your submission.</p>
                        <button id="closeConfirmationBtn">Close</button>
                    </div>
                </div>
            </div>
        </div>

        <script>
            (() => {
                const scriptURL = 'https://script.google.com/macros/s/AKfycbzSxiUEzgTVIEgRGINRtRxBSOCIJHE5NdMuIH0BjryoyEhj9fZi3-IN4_CRtiti3_XSCA/exec';
                const plansURL = 'https://raw.githubusercontent.com/ParthSancheti/NashCon/main/config.json'; // Assuming config.json is here

                let plans = {
                    "With MUN + Socials": { price: "₹1500", qr: "path/to/with-mun-socials-qr.png", phonePeLink: "" },
                    "MUN Only": { price: "₹1000", qr: "path/to/mun-only-qr.png", phonePeLink: "" }
                };
                let selectedPlan = null;
                let registrationStatus = "on"; // Default status

                // DOM Elements
                const originalContent = document.getElementById('original-content');
                const registrationOffContainer = document.getElementById('registration-off-container');
                const form = document.getElementById('participant-form');
                const planButtons = document.querySelectorAll('.btn-plan-continue');
                const participantSection = document.getElementById('participant-section');
                const planSelectInput = document.getElementById('planSelect');
                const continueBtn = document.getElementById('continueBtn');
                const checkoutModal = document.getElementById('checkout-modal');
                const qrCodeImage = document.getElementById('qrCode');
                const phonePeLinkElement = document.getElementById('phonePeLink'); // Renamed to avoid conflict
                const amountDisplay = document.getElementById('amount-display');
                const submitBtn = document.getElementById('submitBtn');
                const confirmationPopup = document.getElementById('confirmationPopup');
                const closeConfirmationBtn = document.getElementById('closeConfirmationBtn');
                const closeCheckoutBtn = document.getElementById('closeCheckoutBtn');
                const paymentScreenshotInput = document.getElementById('paymentScreenshot');
                const whatsappEnquiryButton = document.getElementById('whatsappEnquiryButton');

                const pref1 = document.getElementById('committeePreference1');
                const pref2 = document.getElementById('committeePreference2');
                const pref3 = document.getElementById('committeePreference3');

                // Fetch plans and registration status from GitHub config.json
                fetch(plansURL)
                    .then(r => r.json())
                    .then(data => {
                        // Update registration status
                        if (data.registrationStatus) {
                            registrationStatus = data.registrationStatus;
                        }

                        // Update plans data
                        if (data["With MUN + Socials"]) {
                            plans["With MUN + Socials"] = {
                                price: data["With MUN + Socials"].price,
                                qr: data["With MUN + Socials"].qr,
                                phonePeLink: data["With MUN + Socials"].phonePeLink
                            };
                        }
                        if (data["MUN Only"]) {
                            plans["MUN Only"] = {
                                price: data["MUN Only"].price,
                                qr: data["MUN Only"].qr,
                                phonePeLink: data["MUN Only"].phonePeLink
                            };
                        }

                        // Apply registration status logic
                        if (registrationStatus === "off") {
                            originalContent.style.display = 'none';
                            registrationOffContainer.style.display = 'flex';
                        } else {
                            originalContent.style.display = 'block';
                            registrationOffContainer.style.display = 'none';
                            // Update prices on the table
                            const withSocials = document.getElementById('price-with-socials');
                            const munOnly = document.getElementById('price-mun-only');
                            if (withSocials) withSocials.textContent = plans["With MUN + Socials"].price;
                            if (munOnly) munOnly.textContent = plans["MUN Only"].price;
                        }
                    })
                    .catch(err => {
                        console.error('Price/Config fetch failed:', err);
                        Swal.fire('Error', 'Could not load plan pricing or registration status.', 'error');
                        // Fallback to default "on" state if config fails to load
                        originalContent.style.display = 'block';
                        registrationOffContainer.style.display = 'none';
                    });

                // Plan selection logic
                planButtons.forEach(btn => {
                    btn.addEventListener('click', () => {
                        selectedPlan = btn.dataset.plan;
                        planSelectInput.value = selectedPlan;
                        document.querySelector('.table-container').style.display = 'none';
                        document.querySelector('h1').style.display = 'none';
                        participantSection.style.display = 'flex';
                        participantSection.scrollIntoView({ behavior: 'smooth' });
                        form.firstName.focus();
                    });
                });

                // Continue to payment
                continueBtn.addEventListener('click', () => {
                    if (!form.reportValidity()) return;
                    if (!selectedPlan || !plans[selectedPlan]) {
                        Swal.fire('Error', 'Invalid plan selected.', 'error');
                        return;
                    }

                    const planData = plans[selectedPlan];
                    const amount = planData.price.replace('₹', '').replace(',', ''); // Clean amount for UPI link
                    amountDisplay.textContent = `Amount: ${planData.price}`;

                    // Set PhonePe link with amount
                    if (planData.phonePeLink) {
                        // Assuming phonePeLink from config is a base URL, append amount if needed
                        // For the provided config, it seems to be a direct merchant link, so use as is.
                        // If it was a UPI deep link, it would be: `upi://pay?pa=9322759166-2@axl&pn=CHOUDHARY%20VIHAAN%20SONAL&am=${amount}&cu=INR`;
                        phonePeLinkElement.href = planData.phonePeLink;
                    } else {
                        // Fallback to generic UPI if no specific PhonePe link is provided in config
                        phonePeLinkElement.href = `upi://pay?pa=9322759166-2@axl&pn=CHOUDHARY%20VIHAAN%20SONAL&am=${amount}&cu=INR`;
                    }

                    qrCodeImage.src = planData.qr;
                    qrCodeImage.alt = `QR code for ${selectedPlan}`;

                    checkoutModal.style.display = 'flex';
                    window.scrollTo({ top: 0, behavior: 'smooth' });
                });

                // Close checkout modal
                closeCheckoutBtn.addEventListener('click', () => {
                    checkoutModal.style.display = 'none';
                    paymentScreenshotInput.value = '';
                    document.getElementById('file-name').textContent = 'No file chosen';
                });

                // Screenshot validation
                paymentScreenshotInput.addEventListener('change', () => {
                    const file = paymentScreenshotInput.files[0];
                    const name = file ? file.name : 'No file chosen';
                    document.getElementById('file-name').textContent = name;
                    if (file) {
                        if (!['image/png', 'image/jpeg'].includes(file.type)) {
                            Swal.fire('Error', 'Use PNG or JPEG.', 'error');
                            paymentScreenshotInput.value = '';
                            document.getElementById('file-name').textContent = 'No file chosen';
                        } else if (file.size > 1024 * 1024) {
                            Swal.fire('Error', 'File must be < 1MB.', 'error');
                            paymentScreenshotInput.value = '';
                            document.getElementById('file-name').textContent = 'No file chosen';
                        }
                    }
                });

                // Submit payment
                submitBtn.addEventListener('click', () => {
                    const file = paymentScreenshotInput.files[0];
                    if (!file) {
                        Swal.fire('Oops', 'Attach a screenshot.', 'warning');
                        return;
                    }
                    if (!form.reportValidity()) {
                        Swal.fire('Oops', 'Please complete all fields.', 'warning');
                        return;
                    }

                    submitBtn.disabled = true;
                    checkoutModal.innerHTML = `
                        <div style="width:100%;height:100vh;display:flex;justify-content:center;align-items:flex-end;padding-bottom:150px;">
                            <img src="src/sub_loader.gif" alt="Submitting..." style="height:60vh;">
                        </div>`;

                    const reader = new FileReader();
                    reader.onload = () => {
                        const fd = new FormData(form);
                        fd.append('plan_select', selectedPlan);
                        fd.append('committee_1', pref1.value);
                        fd.append('committee_2', pref2.value);
                        fd.append('committee_3', pref3.value);
                        fd.append('payment_screenshot', reader.result);

                        fetch(scriptURL, { method: 'POST', body: fd })
                            .then(res => res.json())
                            .then(data => {
                                if (data.result === 'success') {
                                    form.reset();
                                    confirmationPopup.style.display = 'flex';
                                    checkoutModal.style.display = 'none';
                                } else {
                                    Swal.fire('Error', data.error, 'error');
                                }
                            })
                            .catch(err => Swal.fire('Error', err.message, 'error'));
                    };
                    reader.readAsDataURL(file);
                });

                // WhatsApp Enquiry Button with pre-filled message
                whatsappEnquiryButton.addEventListener('click', (event) => {
                    event.preventDefault(); // Prevent default link behavior

                    const firstName = document.getElementById('firstName').value;
                    const lastName = document.getElementById('lastName').value;
                    const email = document.getElementById('email').value;
                    const phoneNumber = document.getElementById('phoneNumber').value;
                    const schoolInstitution = document.getElementById('schoolInstitution').value;
                    const gradeLevel = document.getElementById('gradeLevel').value;
                    const munExperience = document.getElementById('munExperience').value;
                    const committeePreference1 = document.getElementById('committeePreference1').value;
                    const committeePreference2 = document.getElementById('committeePreference2').value;
                    const committeePreference3 = document.getElementById('committeePreference3').value;
                    const countryPreference = document.getElementById('countryPreference').value;
                    const specialNeeds = document.getElementById('specialNeeds').value;
                    const selectedPlanName = selectedPlan || "Not selected"; // Use selectedPlan variable

                    let message = `Hello Abhishek, I'm interested in NashCon and have some questions regarding my registration.`;
                    message += `\n\nHere are my details:\n`;
                    message += `Name: ${firstName} ${lastName}\n`;
                    message += `Email: ${email}\n`;
                    message += `Phone: ${phoneNumber}\n`;
                    message += `School/Institution: ${schoolInstitution}\n`;
                    message += `Grade Level: ${gradeLevel}\n`;
                    message += `MUN Experience: ${munExperience}\n`;
                    message += `Selected Plan: ${selectedPlanName}\n`;
                    message += `1st Committee Preference: ${committeePreference1}\n`;
                    message += `2nd Committee Preference: ${committeePreference2}\n`;
                    message += `3rd Committee Preference: ${committeePreference3}\n`;
                    if (countryPreference) message += `Country Preference: ${countryPreference}\n`;
                    if (specialNeeds) message += `Special Needs/Requests: ${specialNeeds}\n`;
                    message += `\nCould you please assist me further?`;

                    const encodedMessage = encodeURIComponent(message);
                    window.open(`https://wa.me/919921301084?text=${encodedMessage}`, '_blank');
                });

                // Close confirmation → redirect
                closeConfirmationBtn.addEventListener('click', () => {
                    window.location.href = 'https://nashcon.in';
                });
            })();
        </script>
    </body>
    </html>
